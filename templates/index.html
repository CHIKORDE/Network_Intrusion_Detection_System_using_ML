<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NIDS Dashboard - Network Security Control Center</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(
          135deg,
          #0a0a0a 0%,
          #1a1a2e 50%,
          #16213e 100%
        );
        color: white;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
      }

      /* Animated background */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="a" cx="50%" cy="50%"><stop offset="0%" style="stop-color:%2300ffff;stop-opacity:0.05"/><stop offset="100%" style="stop-color:%2300ffff;stop-opacity:0"/></radialGradient></defs><circle cx="200" cy="200" r="150" fill="url(%23a)"/><circle cx="800" cy="300" r="100" fill="url(%23a)"/><circle cx="400" cy="700" r="120" fill="url(%23a)"/></svg>')
          no-repeat center center;
        background-size: cover;
        animation: float 20s ease-in-out infinite;
        z-index: 1;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(180deg);
        }
      }

      /* Navigation */
      .navbar {
        position: sticky;
        top: 0;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        padding: 1rem 0;
        z-index: 1000;
        box-shadow: 0 2px 20px rgba(0, 255, 255, 0.1);
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .nav-brand {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.5rem;
        font-weight: bold;
        color: #00ffff;
        text-decoration: none;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      }

      .nav-menu {
        display: flex;
        align-items: center;
        gap: 2rem;
      }

      .nav-links {
        display: flex;
        gap: 1.5rem;
        list-style: none;
      }

      .nav-links a {
        color: white;
        text-decoration: none;
        transition: all 0.3s ease;
        padding: 0.5rem 1rem;
        border-radius: 5px;
      }

      .nav-links a:hover {
        color: #00ffff;
        background: rgba(0, 255, 255, 0.1);
      }

      .user-dropdown {
        position: relative;
        display: inline-block;
      }

      .user-btn {
        background: rgba(0, 255, 255, 0.1);
        border: 1px solid rgba(0, 255, 255, 0.3);
        padding: 0.5rem 1rem;
        border-radius: 25px;
        color: #00ffff;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .user-btn:hover {
        background: rgba(0, 255, 255, 0.2);
        border-color: #00ffff;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        top: 100%;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 255, 255, 0.3);
        border-radius: 10px;
        min-width: 200px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        z-index: 1001;
        margin-top: 0.5rem;
      }

      .dropdown-content.show {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .dropdown-content a {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
        color: white;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .dropdown-content a:hover {
        background: rgba(0, 255, 255, 0.1);
        color: #00ffff;
      }

      .dropdown-divider {
        height: 1px;
        background: rgba(0, 255, 255, 0.3);
        margin: 0.5rem 0;
      }

      /* Main Content */
      .main-content {
        position: relative;
        z-index: 10;
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Dashboard Header */
      .dashboard-header {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 255, 255, 0.2);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
      }

      .dashboard-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(0, 255, 255, 0.1),
          transparent
        );
        animation: shimmer 3s linear infinite;
      }

      @keyframes shimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .header-title h1 {
        font-size: 2rem;
        background: linear-gradient(45deg, #00ffff, #0080ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
        text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
      }

      .header-title p {
        color: rgba(255, 255, 255, 0.7);
      }

      .system-status {
        display: flex;
        align-items: center;
        gap: 1rem;
        background: rgba(0, 255, 0, 0.1);
        padding: 1rem;
        border-radius: 10px;
        border: 1px solid rgba(0, 255, 0, 0.3);
      }

      .status-indicator {
        width: 12px;
        height: 12px;
        background: #00ff00;
        border-radius: 50%;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.1);
        }
      }

      /* Cards */
      .card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 255, 255, 0.2);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
        border-color: #00ffff;
        box-shadow: 0 20px 40px rgba(0, 255, 255, 0.2);
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(0, 255, 255, 0.05),
          transparent
        );
        transition: left 0.5s ease;
      }

      .card:hover::before {
        left: 100%;
      }

      .card-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.3rem;
        color: #00ffff;
        margin-bottom: 1.5rem;
      }

      /* Form Styles */
      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .form-label {
        color: #00ffff;
        font-weight: 500;
        font-size: 0.9rem;
      }

      .form-input {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(0, 255, 255, 0.3);
        border-radius: 10px;
        padding: 0.75rem;
        color: white;
        font-size: 1rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .form-input:focus {
        outline: none;
        border-color: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        background: rgba(255, 255, 255, 0.15);
      }

      .form-input::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }

      .btn-analyze {
        background: linear-gradient(45deg, #00ffff, #0080ff);
        border: none;
        border-radius: 25px;
        padding: 1rem 2rem;
        color: white;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin: 2rem auto 0;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .btn-analyze:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(0, 255, 255, 0.4);
        background: linear-gradient(45deg, #0080ff, #00ffff);
      }

      /* Alert Styles */
      .alert {
        padding: 1.5rem;
        border-radius: 15px;
        margin-bottom: 1.5rem;
        border: 1px solid;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        gap: 1rem;
        animation: slideIn 0.5s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .alert-success {
        background: rgba(0, 255, 0, 0.1);
        border-color: #00ff00;
        color: #00ff00;
      }

      .alert-danger {
        background: rgba(255, 0, 0, 0.1);
        border-color: #ff4444;
        color: #ff4444;
      }

      .alert-info {
        background: rgba(0, 255, 255, 0.1);
        border-color: #00ffff;
        color: #00ffff;
      }

      .alert-warning {
        background: rgba(255, 255, 0, 0.1);
        border-color: #ffff00;
        color: #ffff00;
      }

      .alert-icon {
        font-size: 2rem;
        flex-shrink: 0;
      }

      .alert-content h4 {
        margin-bottom: 0.5rem;
        font-size: 1.3rem;
      }

      .alert-content p {
        margin: 0;
        font-size: 1.1rem;
      }

      .close-btn {
        background: none;
        border: none;
        color: inherit;
        font-size: 1.5rem;
        cursor: pointer;
        margin-left: auto;
        padding: 0.25rem;
        opacity: 0.7;
        transition: opacity 0.3s ease;
      }

      .close-btn:hover {
        opacity: 1;
      }

      /* Chart Container */
      .chart-container {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 2rem;
        align-items: start;
      }

      .chart-canvas {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 15px;
        padding: 1rem;
        min-height: 400px;
      }

      .chart-stats {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        border: 1px solid rgba(0, 255, 255, 0.2);
        transition: all 0.3s ease;
      }

      .stat-item:hover {
        border-color: #00ffff;
        background: rgba(255, 255, 255, 0.08);
      }

      .stat-badge {
        padding: 0.5rem 1rem;
        border-radius: 25px;
        font-weight: 600;
        font-size: 0.9rem;
      }

      .badge-success {
        background: rgba(0, 255, 0, 0.2);
        color: #00ff00;
        border: 1px solid rgba(0, 255, 0, 0.3);
      }

      .badge-danger {
        background: rgba(255, 0, 0, 0.2);
        color: #ff4444;
        border: 1px solid rgba(255, 0, 0, 0.3);
      }

      .total-stats {
        background: rgba(0, 255, 255, 0.1);
        border: 1px solid rgba(0, 255, 255, 0.3);
        border-radius: 10px;
        padding: 1rem;
        text-align: center;
        margin-top: 1rem;
      }

      .total-number {
        font-size: 2rem;
        font-weight: bold;
        color: #00ffff;
        display: block;
      }

      /* Footer */
      .footer {
        text-align: center;
        padding: 2rem;
        color: rgba(255, 255, 255, 0.6);
        border-top: 1px solid rgba(0, 255, 255, 0.2);
        margin-top: 3rem;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .nav-container {
          padding: 0 1rem;
        }

        .nav-links {
          display: none;
        }

        .main-content {
          padding: 1rem;
        }

        .header-content {
          flex-direction: column;
          text-align: center;
        }

        .form-grid {
          grid-template-columns: 1fr;
        }

        .chart-container {
          grid-template-columns: 1fr;
        }

        .dashboard-header h1 {
          font-size: 1.5rem;
        }
      }

      /* Network nodes animation */
      .network-node {
        position: fixed;
        width: 4px;
        height: 4px;
        background: #00ffff;
        border-radius: 50%;
        opacity: 0.6;
        animation: networkPulse 2s ease-in-out infinite;
        z-index: 2;
      }

      @keyframes networkPulse {
        0%,
        100% {
          opacity: 0.3;
          transform: scale(1);
        }
        50% {
          opacity: 1;
          transform: scale(1.5);
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar">
      <div class="nav-container">
        <a href="{{ url_for('home') }}" class="nav-brand">
          üõ°Ô∏è NIDS Control Center
        </a>
        <div class="nav-menu">
          <ul class="nav-links">
            <li><a href="{{ url_for('home') }}">üè† Home</a></li>
            <li><a href="{{ url_for('profile') }}">üë§ Profile</a></li>
            {% if session['username'].lower() == 'admin' %}
            <li><a href="{{ url_for('admin') }}">üõ†Ô∏è Admin Panel</a></li>
            {% endif %}
          </ul>
          <div class="user-dropdown">
            <button class="user-btn" onclick="toggleDropdown()">
              üë§ {{ username }} ‚ñæ
            </button>
            <div class="dropdown-content" id="userDropdown">
              <a href="{{ url_for('profile') }}">üë§ Profile</a>

              <div class="dropdown-divider"></div>
              <a href="{{ url_for('logout') }}">üö™ Logout</a>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <div class="main-content">
      <!-- Dashboard Header -->
      <div class="dashboard-header">
        <div class="header-content">
          <div class="header-title">
            <h1>üåê Network Security Control Center</h1>
            <p>
              Welcome back, {{ username }}! Session active since {{ login_time
              }}
            </p>
          </div>
          <div class="system-status">
            <div class="status-indicator"></div>
            <div>
              <div style="font-weight: 600; color: #00ff00">System Online</div>
              <div style="font-size: 0.9rem; opacity: 0.8">
                All systems operational
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div
        class="alert alert-{% if category == 'error' %}danger{% elif category == 'success' %}success{% elif category == 'warning' %}warning{% else %}info{% endif %}"
      >
        <div class="alert-icon">
          {% if category == 'error' %}‚ö†Ô∏è {% elif category == 'success' %}‚úÖ {%
          elif category == 'warning' %}‚ö†Ô∏è {% else %}‚ÑπÔ∏è{% endif %}
        </div>
        <div class="alert-content">
          <p>{{ message }}</p>
        </div>
        <button class="close-btn" onclick="this.parentElement.remove()">
          √ó
        </button>
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <!-- Traffic Analysis Form -->
      <div class="card">
        <h3 class="card-title">üìä Network Traffic Analysis</h3>
        <form method="POST">
          <div class="form-grid">
            {% for feat in features %}
            <div class="form-group">
              <label class="form-label">{{ feat }}</label>
              <input
                type="text"
                class="form-input"
                name="{{ feat }}"
                placeholder="Enter {{ feat | lower }}"
                required
              />
            </div>
            {% endfor %}
          </div>
          <button type="submit" class="btn-analyze">
            üß† Analyze Network Traffic
          </button>
        </form>
      </div>

      <!-- Prediction Result -->
      {% if prediction %}
      <div class="card">
        <h3 class="card-title">üéØ Analysis Results</h3>
        <div
          class="alert {% if 'BENIGN' in prediction.upper() %}alert-success{% else %}alert-danger{% endif %}"
        >
          <div class="alert-icon">
            {% if 'BENIGN' in prediction.upper() %}üõ°Ô∏è{% else %}üö®{% endif %}
          </div>
          <div class="alert-content">
            <h4>
              {% if 'BENIGN' in prediction.upper() %} ‚úÖ Traffic Classification:
              SECURE {% else %} üö® THREAT DETECTED! {% endif %}
            </h4>
            <p><strong>Classification:</strong> {{ prediction }}</p>
            {% if confidence %}
            <p>
              <strong>Confidence Level:</strong> {{ "%.1f"|format(confidence)
              }}%
            </p>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Prediction History Chart -->
      {% if history %}
      <div class="card">
        <h3 class="card-title">üìà Prediction History Overview</h3>
        <div class="chart-container">
          <div class="chart-canvas">
            <canvas id="predictionChart"></canvas>
          </div>
          <div class="chart-stats">
            <h6 style="color: #00ffff; margin-bottom: 1rem; font-size: 1.1rem">
              üìä Detection Statistics
            </h6>
            {% for label, count in history.items() %}
            <div class="stat-item">
              <span
                class="stat-badge {% if 'BENIGN' in label.upper() %}badge-success{% else %}badge-danger{% endif %}"
              >
                {{ label }}
              </span>
              <strong style="color: #00ffff">{{ count }}</strong>
            </div>
            {% endfor %}
            <div class="total-stats">
              <span class="total-number">{{ history.values() | sum }}</span>
              <div style="color: rgba(255, 255, 255, 0.7)">Total Analyses</div>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>
        üõ°Ô∏è NIDS AI Control Center ¬© 2025 - Advanced Network Security Monitoring
        System
      </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
            // Dropdown functionality
            function toggleDropdown() {
                document.getElementById("userDropdown").classList.toggle("show");
            }

            // Close dropdown when clicking outside
            window.onclick = function(event) {
                if (!event.target.matches('.user-btn')) {
                    var dropdowns = document.getElementsByClassName("dropdown-content");
                    for (var i = 0; i < dropdowns.length; i++) {
                        var openDropdown = dropdowns[i];
                        if (openDropdown.classList.contains('show')) {
                            openDropdown.classList.remove('show');
                        }
                    }
                }
            }

            // Create network nodes animation
            function createNetworkNodes() {
                const nodeCount = 15;
                for (let i = 0; i < nodeCount; i++) {
                    const node = document.createElement('div');
                    node.className = 'network-node';
                    node.style.left = Math.random() * 100 + '%';
                    node.style.top = Math.random() * 100 + '%';
                    node.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(node);
                }
            }
            //admin visible button
            {% if session['username'] == 'admin' %}
      <li><a href="{{ url_for('admin') }}">Admin Panel</a></li>
      {% endif %}

            // Chart initialization
            {% if history %}
            const ctx = document.getElementById('predictionChart').getContext('2d');
            const chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: {{ history.keys()|list|safe }},
                    datasets: [{
                        label: 'Detection Counts',
                        data: {{ history.values()|list }},
                        backgroundColor: [
                            '#00ff00', '#ff4444', '#ffff00', '#00ffff',
                            '#ff00ff', '#ff8800', '#00ff88', '#8800ff'
                        ],
                        borderWidth: 2,
                        borderColor: '#00ffff',
                        hoverOffset: 15,
                        hoverBorderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                color: '#ffffff',
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#00ffff',
                            bodyColor: '#ffffff',
                            borderColor: '#00ffff',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed * 100) / total).toFixed(1);
                                    return context.label + ': ' + context.parsed + ' (' + percentage + '%)';
                                }
                            }
                        }
                    },
                    cutout: '60%',
                    elements: {
                        arc: {
                            borderWidth: 2
                        }
                    }
                }
            });
            {% endif %}

            // Initialize animations
            document.addEventListener('DOMContentLoaded', function() {
                createNetworkNodes();

                // Auto-hide flash messages
                setTimeout(() => {
                    document.querySelectorAll('.alert').forEach(alert => {
                        if (alert.querySelector('.close-btn')) {
                            alert.style.animation = 'slideIn 0.5s ease reverse';
                            setTimeout(() => alert.remove(), 500);
                        }
                    });
                }, 5000);
            });

            // Add some interactivity
            document.addEventListener('mousemove', function(e) {
                if (Math.random() > 0.98) {
                    const particle = document.createElement('div');
                    particle.style.position = 'fixed';
                    particle.style.left = e.clientX + 'px';
                    particle.style.top = e.clientY + 'px';
                    particle.style.width = '2px';
                    particle.style.height = '2px';
                    particle.style.background = '#00ffff';
                    particle.style.borderRadius = '50%';
                    particle.style.pointerEvents = 'none';
                    particle.style.zIndex = '9999';
                    particle.style.animation = 'networkPulse 1s ease-out forwards';

                    document.body.appendChild(particle);

                    setTimeout(() => {
                        particle.remove();
                    }, 1000);
                }
            });
    </script>
  </body>
</html>
